---
## Author
author:
  name: Сергей Павленко
  email: 1032235868@rudn.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6

## Title
title: "Математическое моделирование"
subtitle: "Лабораторная работа № 2"
license: "CC BY"
---

# Цель работы

Рассмотрим пример построения математической модели, которая помогает выбрать оптимальную стратегию в задачах поиска и преследования.  
В качестве иллюстрации возьмём ситуацию: в тумане катер береговой охраны ведёт погоню за лодкой браконьеров. Через некоторое время туман рассеивается, и лодка фиксируется на расстоянии $k$ км от катера. Далее лодка вновь исчезает в тумане и продолжает движение прямолинейно в неизвестном направлении. Известно, что скорость катера в $n$ раз больше скорости лодки.  
Требуется определить траекторию движения катера, обеспечивающую перехват лодки.

# Задание

1. Выполнить рассуждения и вывести дифференциальные уравнения при условии, что скорость катера превышает скорость лодки в $n$ раз.
2. Построить траектории движения катера и лодки для двух вариантов начального положения.
3. По построенным графикам определить точку встречи (пересечения траекторий).

# Выполнение лабораторной работы

Положим момент обнаружения за начало отсчёта: $t_0=0$. Точку обнаружения лодки принимаем за начало координат. В этот момент лодка находится в точке $X_0=0$, а катер — на расстоянии $k$ относительно лодки.

Перейдём к полярной системе координат. Пусть полюс — это точка обнаружения лодки ($r=0$), а полярная ось $r$ направлена в сторону положения катера в момент обнаружения.

## Определение радиуса перехода к «обходу полюса»

Найдём расстояние $x$ от полюса, при достижении которого катер и лодка окажутся на одном радиусе. За время $t$ лодка проходит путь $x$ со скоростью $v$, а катер — путь $x\pm k$ со скоростью $nv$ (знак зависит от того, по какую сторону полюса был катер).

Приравниваем времена движения:
- для варианта «plus»: $\dfrac{x}{v}=\dfrac{x+k}{nv}$,
- для варианта «minus»: $\dfrac{x}{v}=\dfrac{x-k}{nv}$.

Отсюда получаем два стартовых радиуса:

- $x_1=\dfrac{k}{n+1}$ при $\theta=0$,
- $x_2=\dfrac{k}{n-1}$ при $\theta=-\pi$.

Далее, когда катер оказывается на том же радиусе, что и лодка, он должен перейти от прямолинейного движения к движению вокруг полюса, одновременно удаляясь от него с той же радиальной скоростью, что и лодка (чтобы не «проигрывать» по удалению).

## Разложение скорости катера

Скорость катера разложим на две компоненты:
- радиальная: $v_r=\dfrac{dr}{dt}$,
- тангенциальная: $v_t=r\dfrac{d\theta}{dt}$.

Требуемое условие по радиальной скорости:
$$
v_r=\frac{dr}{dt}=v.
$$

Полная скорость катера равна $nv$, а компоненты образуют прямоугольный треугольник, поэтому:
$$
(nv)^2=v_r^2+v_t^2.
$$

Подставляя $v_r=v$, получаем:
$$
v_t=v\sqrt{n^2-1}.
$$

То есть:
$$
r\frac{d\theta}{dt}=v\sqrt{n^2-1}.
$$

## Система дифференциальных уравнений

Таким образом, задача сводится к решению системы:
$$
\begin{cases}
\frac{dr}{dt}=v,\\
r\frac{d\theta}{dt}=v\sqrt{n^2-1}.
\end{cases}
$$

Начальные условия для двух сценариев:

**Сценарий 1**
$$
\begin{cases}
\theta_0=0,\\
r_0=\frac{k}{n+1}.
\end{cases}
$$

**Сценарий 2**
$$
\begin{cases}
\theta_0=-\pi,\\
r_0=\frac{k}{n-1}.
\end{cases}
$$

Исключая параметр $t$, получаем уравнение траектории катера:
$$
\frac{dr}{d\theta}=\frac{r}{\sqrt{n^2-1}}.
$$

Решив его с соответствующим начальным условием, получаем искомую траекторию катера в полярных координатах.

## Условие задачи

На море в тумане катер береговой охраны преследует лодку браконьеров.  
После рассеивания тумана лодка обнаружена на расстоянии 20 км от катера.  
Затем лодка снова скрывается и движется прямолинейно в неизвестном направлении.  
Скорость катера в 5 раз больше скорости лодки, то есть $k=20$, $n=5$.

Для моделирования процесса и построения графиков использовались внешние файлы с программным кодом:

{{< include ../project/markdown/01_task_of_chase/01_task_of_chase.qmd >}}

{{< include ../project/markdown/02_task_of_chase/02_task_of_chase.qmd >}}

## Анализ результатов моделирования

В ходе работы выполнено численное исследование движения катера, описываемого уравнением:
$$
\frac{dr}{d\theta}=\frac{r}{\sqrt{n^2-1}},
$$
а также сопоставление полученной траектории со траекторией лодки, заданной аналитически и представленной в полярных координатах.

## Базовые эксперименты

### 1. Случай (case = plus)

![Базовый эксперимент (case=plus)](image/single_experiment.png)

По полярному графику видно, что траектория катера представляет собой расходящуюся спираль: при росте угла $\theta$ радиус $r$ увеличивается монотонно. Причина в том, что $dr/d\theta$ пропорциональна $r$, из-за чего рост по $\theta$ приобретает экспоненциальный характер.

Траектория лодки в полярной системе выражается лучом, поскольку в декартовой системе она движется по прямой.

По рисунку заметно, что катер увеличивает радиус быстрее, чем лодка, и постепенно «обходит» её по траектории, создавая условия для перехвата.

### 2. Случай (case = minus)

![Базовый эксперимент (case=minus)](image/single_experiment_minus.png)

Во втором сценарии стартовый радиус больше, поэтому катер начинает движение дальше от полюса. Форма траектории остаётся той же (спираль), однако весь график оказывается сдвинут наружу, то есть отличается масштабом.

Таким образом, отличие case=plus и case=minus проявляется главным образом в начальных условиях, а не в типе траектории.

## Параметрическое сканирование по $n$

![Сканирование траекторий катера](image/parametric_scan_cutter_comparison.png)

Проверено влияние параметра $n$ на динамику системы для обоих режимов.

Из уравнения следует, что «крутизна» спирали определяется коэффициентом
$$
\frac{1}{\sqrt{n^2-1}}.
$$

Следовательно:
- при меньших $n$ спираль расходится быстрее;
- при больших $n$ увеличение радиуса происходит медленнее;
- траектории становятся более «пологими» и менее быстро расходящимися.

По графику видно: при $n=3$ рост наиболее интенсивный, а при $n=10$ — наиболее медленный.

## Анализ метрики scale_ratio

![Зависимость scale_ratio от n](image/scale_ratio_vs_n.png)

Для сравнения масштабов введена метрика:
$$
\text{scale\_ratio}=\frac{r_{\text{final}}}{\max(r_{\text{boat}})}.
$$

Наблюдения по графику:
- при малых $n$ значение существенно превышает 1, то есть катер уходит по радиусу заметно дальше лодки;
- с ростом $n$ метрика быстро уменьшается;
- при больших $n$ масштабы траекторий становятся ближе друг к другу.

В режиме case=minus метрика закономерно больше, так как стартовый радиус выше.

## Время вычислений

![Зависимость времени вычисления от n](image/computation_time_vs_n.png)

Проведён бенчмаркинг численного решения ОДУ для различных значений $n$.

Из результата следует:
- время вычислений находится на уровне $\sim 6\times 10^{-4}$ секунды;
- заметной зависимости от $n$ не выявлено;
- небольшие флуктуации связаны с особенностями адаптивного шага и внутренней численной обработкой.

# Выводы

1. Траектория катера в полярной системе координат описывается расходящейся (экспоненциальной по углу) спиралью.
2. Параметр $n$ влияет на скорость радиального роста: чем больше $n$, тем медленнее «раскручивается» спираль.
3. Выбор начального условия (case) изменяет масштаб траектории, но не изменяет её качественную форму.
4. Численное решение устойчиво, а вычислительные затраты практически не зависят от параметров модели.

Итоги моделирования согласуются с аналитическим видом полученного дифференциального уравнения.

# Список литературы {.unnumbered}

1. [Задача о погоне](https://esystem.rudn.ru/pluginfile.php/2290141/mod_resource/content/2/Лабораторная%20работа%20№%201.pdf)
